<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GlobeTrotter Smart Planner - Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
            overflow-x: auto;
        }

        .nav-tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: transparent;
            font-size: 1em;
            font-weight: 500;
            color: #666;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .nav-tab:hover {
            background: #e9ecef;
            color: #333;
        }

        .nav-tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: white;
        }

        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.3s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .trip-card {
            border-left: 4px solid #667eea;
        }

        .trip-card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .trip-meta {
            display: flex;
            gap: 20px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .trip-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #666;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-success {
            background: #d4edda;
            color: #155724;
        }

        .badge-warning {
            background: #fff3cd;
            color: #856404;
        }

        .badge-info {
            background: #d1ecf1;
            color: #0c5460;
        }

        .planstream-feed {
            display: grid;
            gap: 20px;
        }

        .planstream-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 12px;
            padding: 20px;
            position: relative;
        }

        .planstream-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .planstream-actions button {
            flex: 1;
            padding: 8px;
            font-size: 0.9em;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .stat-card p {
            opacity: 0.9;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .alert-info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }

        .city-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .city-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .city-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .city-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
        }

        .hidden {
            display: none;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state svg {
            width: 100px;
            height: 100px;
            margin-bottom: 20px;
            opacity: 0.3;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üåç GlobeTrotter Smart Planner</h1>
            <p>Context-Aware Travel Planning Platform</p>
        </header>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">Dashboard</button>
            <button class="nav-tab" onclick="showTab('create-trip')">Create Trip</button>
            <button class="nav-tab" onclick="showTab('planstream')">PlanStream</button>
            <button class="nav-tab" onclick="showTab('cities')">Cities</button>
            <button class="nav-tab" onclick="showTab('quickplan')">QuickPlan</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <h2>Dashboard</h2>
            <div class="stats-grid" id="statsGrid"></div>
            <div id="tripsList"></div>
        </div>

        <!-- Create Trip Tab -->
        <div id="create-trip" class="tab-content">
            <h2>Create New Trip</h2>
            <div class="card">
                <form id="tripForm">
                    <div class="form-group">
                        <label>Trip Name</label>
                        <input type="text" id="tripName" required placeholder="e.g., European Adventure">
                    </div>
                    <div class="form-group">
                        <label>Start Date</label>
                        <input type="date" id="startDate" required>
                    </div>
                    <div class="form-group">
                        <label>End Date</label>
                        <input type="date" id="endDate" required>
                    </div>
                    <div class="form-group">
                        <label>Budget ($)</label>
                        <input type="number" id="budget" required min="0" placeholder="1000">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="description" rows="3" placeholder="Describe your trip..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Travel Style</label>
                        <select id="travelStyle">
                            <option value="explorer">Explorer</option>
                            <option value="relaxed">Relaxed</option>
                            <option value="adventure">Adventure</option>
                            <option value="fast">Fast Paced</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">Create Trip & Auto Plan</button>
                </form>
            </div>
        </div>

        <!-- PlanStream Tab -->
        <div id="planstream" class="tab-content">
            <h2>PlanStream</h2>
            <div class="planstream-feed" id="planstreamFeed"></div>
        </div>

        <!-- Cities Tab -->
        <div id="cities" class="tab-content">
            <h2>Popular Cities</h2>
            <div class="city-grid" id="citiesGrid"></div>
        </div>

        <!-- QuickPlan Tab -->
        <div id="quickplan" class="tab-content">
            <h2>QuickPlan - Instant Planning</h2>
            <div class="card">
                <form id="quickplanForm">
                    <div class="form-group">
                        <label>Current Location</label>
                        <input type="text" id="quickLocation" required placeholder="e.g., Paris, France">
                    </div>
                    <div class="form-group">
                        <label>Available Time (Hours)</label>
                        <input type="number" id="quickHours" required min="1" max="24" value="8">
                    </div>
                    <div class="form-group">
                        <label>Budget ($)</label>
                        <input type="number" id="quickBudget" required min="0" placeholder="100">
                    </div>
                    <button type="submit" class="btn btn-primary">Generate Quick Plan</button>
                </form>
                <div id="quickplanResults" class="hidden" style="margin-top: 20px;"></div>
            </div>
        </div>
    </div>

    <script>
        // Database using localStorage
        const DB = {
            trips: JSON.parse(localStorage.getItem('trips') || '[]'),
            cities: JSON.parse(localStorage.getItem('cities') || '[]'),
            activities: JSON.parse(localStorage.getItem('activities') || '[]'),
            
            save() {
                localStorage.setItem('trips', JSON.stringify(this.trips));
                localStorage.setItem('cities', JSON.stringify(this.cities));
                localStorage.setItem('activities', JSON.stringify(this.activities));
            },
            
            init() {
                if (this.cities.length === 0) {
                    this.cities = [
                        { id: 1, name: 'Paris', country: 'France', popularity: 95, costIndex: 75, trending: true },
                        { id: 2, name: 'Tokyo', country: 'Japan', popularity: 92, costIndex: 80, trending: true },
                        { id: 3, name: 'New York', country: 'USA', popularity: 90, costIndex: 85, trending: true },
                        { id: 4, name: 'London', country: 'UK', popularity: 88, costIndex: 70, trending: false },
                        { id: 5, name: 'Dubai', country: 'UAE', popularity: 85, costIndex: 65, trending: true },
                        { id: 6, name: 'Bangkok', country: 'Thailand', popularity: 82, costIndex: 40, trending: false },
                        { id: 7, name: 'Sydney', country: 'Australia', popularity: 80, costIndex: 60, trending: false }
                    ];
                }
                
                if (this.activities.length === 0) {
                    this.activities = [
                        { id: 1, cityId: 1, name: 'Eiffel Tower', category: 'sightseeing', cost: 25, duration: 2 },
                        { id: 2, cityId: 1, name: 'Louvre Museum', category: 'culture', cost: 17, duration: 4 },
                        { id: 3, cityId: 1, name: 'French Cuisine Tour', category: 'food', cost: 80, duration: 3 },
                        { id: 4, cityId: 2, name: 'Senso-ji Temple', category: 'culture', cost: 0, duration: 2 },
                        { id: 5, cityId: 2, name: 'Sushi Making Class', category: 'food', cost: 120, duration: 2.5 },
                        { id: 6, cityId: 3, name: 'Central Park', category: 'nature', cost: 0, duration: 3 },
                        { id: 7, cityId: 3, name: 'Statue of Liberty', category: 'sightseeing', cost: 24, duration: 3 }
                    ];
                }
                this.save();
            }
        };

        // Initialize database
        DB.init();

        // Tab navigation
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Refresh content when switching tabs
            if (tabName === 'dashboard') loadDashboard();
            if (tabName === 'planstream') loadPlanStream();
            if (tabName === 'cities') loadCities();
        }

        // Dashboard
        function loadDashboard() {
            const stats = calculateStats();
            const statsHtml = `
                <div class="stat-card">
                    <h3>${stats.totalTrips}</h3>
                    <p>Total Trips</p>
                </div>
                <div class="stat-card">
                    <h3>${stats.activeTrips}</h3>
                    <p>Active Trips</p>
                </div>
                <div class="stat-card">
                    <h3>$${stats.totalBudget.toLocaleString()}</h3>
                    <p>Total Budget</p>
                </div>
                <div class="stat-card">
                    <h3>${stats.totalCities}</h3>
                    <p>Cities Visited</p>
                </div>
            `;
            document.getElementById('statsGrid').innerHTML = statsHtml;
            
            const tripsHtml = DB.trips.length === 0 
                ? '<div class="empty-state"><h3>No trips yet</h3><p>Create your first trip to get started!</p></div>'
                : DB.trips.map(trip => `
                    <div class="card trip-card">
                        <h3>${trip.name}</h3>
                        <div class="trip-meta">
                            <span>üìÖ ${trip.startDate} - ${trip.endDate}</span>
                            <span>üí∞ Budget: $${trip.budget}</span>
                            <span>üèôÔ∏è Cities: ${trip.cities?.length || 0}</span>
                            <span class="badge ${trip.status === 'active' ? 'badge-success' : trip.status === 'planned' ? 'badge-info' : 'badge-warning'}">${trip.status}</span>
                        </div>
                        <p>${trip.description || 'No description'}</p>
                        <div style="margin-top: 15px;">
                            <button class="btn btn-secondary" onclick="viewTrip(${trip.id})">View</button>
                            <button class="btn btn-danger" onclick="deleteTrip(${trip.id})">Delete</button>
                        </div>
                    </div>
                `).join('');
            document.getElementById('tripsList').innerHTML = tripsHtml;
        }

        function calculateStats() {
            return {
                totalTrips: DB.trips.length,
                activeTrips: DB.trips.filter(t => t.status === 'active').length,
                totalBudget: DB.trips.reduce((sum, t) => sum + (t.budget || 0), 0),
                totalCities: new Set(DB.trips.flatMap(t => t.cities?.map(c => c.cityId) || [])).size
            };
        }

        // Create Trip
        document.getElementById('tripForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const trip = {
                id: Date.now(),
                name: document.getElementById('tripName').value,
                startDate: document.getElementById('startDate').value,
                endDate: document.getElementById('endDate').value,
                budget: parseFloat(document.getElementById('budget').value),
                description: document.getElementById('description').value,
                travelStyle: document.getElementById('travelStyle').value,
                status: 'planned',
                cities: autoPlanTrip(
                    document.getElementById('startDate').value,
                    document.getElementById('endDate').value,
                    parseFloat(document.getElementById('budget').value),
                    document.getElementById('travelStyle').value
                ),
                createdAt: new Date().toISOString()
            };
            
            DB.trips.push(trip);
            DB.save();
            
            showAlert('Trip created successfully!', 'success');
            this.reset();
            showTab('dashboard');
            loadDashboard();
        });

        function autoPlanTrip(startDate, endDate, budget, style) {
            const days = Math.ceil((new Date(endDate) - new Date(startDate)) / (1000 * 60 * 60 * 24));
            const budgetPerDay = budget / days;
            const selectedCities = [];
            let remainingBudget = budget;
            
            // Select cities based on style and budget
            const cityPool = [...DB.cities].sort((a, b) => b.popularity - a.popularity);
            
            for (let i = 0; i < Math.min(3, cityPool.length) && remainingBudget > 0; i++) {
                const city = cityPool[i];
                const cityActivities = DB.activities.filter(a => a.cityId === city.id);
                const cityCost = cityActivities.reduce((sum, a) => sum + a.cost, 0) * 0.3; // 30% of activities
                
                if (cityCost <= remainingBudget) {
                    selectedCities.push({
                        cityId: city.id,
                        cityName: city.name,
                        days: Math.min(2, days - selectedCities.length * 2),
                        activities: cityActivities.slice(0, 3),
                        cost: cityCost
                    });
                    remainingBudget -= cityCost;
                }
            }
            
            return selectedCities;
        }

        // PlanStream
        function loadPlanStream() {
            const feedHtml = DB.trips.length === 0
                ? '<div class="empty-state"><h3>No trips in PlanStream</h3><p>Create a trip to see it here!</p></div>'
                : DB.trips.map(trip => `
                    <div class="planstream-card">
                        <h3>${trip.name}</h3>
                        <div class="trip-meta">
                            <span>üìÖ ${trip.startDate}</span>
                            <span>üí∞ $${trip.budget}</span>
                            <span class="badge ${trip.status === 'active' ? 'badge-success' : 'badge-info'}">${trip.status}</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${(trip.cities?.length || 0) * 20}%"></div>
                        </div>
                        <div class="planstream-actions">
                            <button class="btn btn-primary" onclick="optimizeBudget(${trip.id})">Optimize Budget</button>
                            <button class="btn btn-success" onclick="activateTrip(${trip.id})">Activate</button>
                            <button class="btn btn-secondary" onclick="viewTrip(${trip.id})">View Details</button>
                        </div>
                    </div>
                `).join('');
            document.getElementById('planstreamFeed').innerHTML = feedHtml;
        }

        function optimizeBudget(tripId) {
            const trip = DB.trips.find(t => t.id === tripId);
            if (trip) {
                // Simple optimization: reduce activity costs by 10%
                trip.cities?.forEach(city => {
                    city.activities?.forEach(activity => {
                        activity.cost = Math.round(activity.cost * 0.9);
                    });
                    city.cost = city.activities?.reduce((sum, a) => sum + a.cost, 0) * 0.3;
                });
                DB.save();
                showAlert('Budget optimized! Saved 10% on activities.', 'success');
                loadPlanStream();
            }
        }

        function activateTrip(tripId) {
            const trip = DB.trips.find(t => t.id === tripId);
            if (trip) {
                trip.status = 'active';
                DB.save();
                showAlert('Trip activated! GPS alerts will be active.', 'success');
                loadPlanStream();
                loadDashboard();
            }
        }

        // Cities
        function loadCities() {
            const citiesHtml = DB.cities.map(city => `
                <div class="city-card" onclick="selectCity(${city.id})">
                    <h4>${city.name}</h4>
                    <p>${city.country}</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${city.popularity}%"></div>
                    </div>
                    <p style="margin-top: 10px; font-size: 0.9em;">
                        Popularity: ${city.popularity}% | 
                        Cost Index: ${city.costIndex}/100
                    </p>
                    ${city.trending ? '<span class="badge badge-success">Trending</span>' : ''}
                </div>
            `).join('');
            document.getElementById('citiesGrid').innerHTML = citiesHtml;
        }

        function selectCity(cityId) {
            showAlert(`Selected ${DB.cities.find(c => c.id === cityId)?.name}. Add it to a trip!`, 'info');
        }

        // QuickPlan
        document.getElementById('quickplanForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const location = document.getElementById('quickLocation').value;
            const hours = parseInt(document.getElementById('quickHours').value);
            const budget = parseFloat(document.getElementById('quickBudget').value);
            
            // Find nearby activities (simplified - just get random activities)
            const availableActivities = DB.activities
                .filter(a => a.duration <= hours && a.cost <= budget)
                .slice(0, 5);
            
            const totalCost = availableActivities.reduce((sum, a) => sum + a.cost, 0);
            const totalTime = availableActivities.reduce((sum, a) => sum + a.duration, 0);
            
            const resultsHtml = `
                <div class="alert alert-success">
                    <h4>QuickPlan Generated for ${location}</h4>
                    <p>Found ${availableActivities.length} activities within your budget and time!</p>
                </div>
                <div style="margin-top: 20px;">
                    ${availableActivities.map(activity => {
                        const city = DB.cities.find(c => c.id === activity.cityId);
                        return `
                            <div class="card">
                                <h4>${activity.name}</h4>
                                <p><strong>Location:</strong> ${city?.name || 'Unknown'}</p>
                                <p><strong>Category:</strong> ${activity.category}</p>
                                <p><strong>Cost:</strong> $${activity.cost} | <strong>Duration:</strong> ${activity.duration} hours</p>
                            </div>
                        `;
                    }).join('')}
                </div>
                <div class="card" style="background: #f8f9fa; margin-top: 20px;">
                    <p><strong>Total Cost:</strong> $${totalCost.toFixed(2)} / $${budget}</p>
                    <p><strong>Total Time:</strong> ${totalTime.toFixed(1)} hours / ${hours} hours</p>
                    <p><strong>Budget Remaining:</strong> $${(budget - totalCost).toFixed(2)}</p>
                </div>
            `;
            
            document.getElementById('quickplanResults').innerHTML = resultsHtml;
            document.getElementById('quickplanResults').classList.remove('hidden');
        });

        // Utility functions
        function showAlert(message, type) {
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;
            document.querySelector('.container').insertBefore(alert, document.querySelector('.container').firstChild);
            setTimeout(() => alert.remove(), 3000);
        }

        function viewTrip(tripId) {
            const trip = DB.trips.find(t => t.id === tripId);
            if (trip) {
                alert(`Trip: ${trip.name}\nDates: ${trip.startDate} to ${trip.endDate}\nBudget: $${trip.budget}\nCities: ${trip.cities?.length || 0}\nStatus: ${trip.status}`);
            }
        }

        function deleteTrip(tripId) {
            if (confirm('Are you sure you want to delete this trip?')) {
                DB.trips = DB.trips.filter(t => t.id !== tripId);
                DB.save();
                showAlert('Trip deleted!', 'success');
                loadDashboard();
            }
        }

        // Set today's date as default
        document.getElementById('startDate').valueAsDate = new Date();
        const endDate = new Date();
        endDate.setDate(endDate.getDate() + 7);
        document.getElementById('endDate').valueAsDate = endDate;

        // Initial load
        loadDashboard();
    </script>
</body>
</html>

